---
import WhatsappBtn from '../components/WhatsappBtn.astro';
import { supabase } from '../lib/supabase';

// Verificar autenticaci√≥n con Supabase
const { cookies } = Astro;
const accessToken = cookies.get('sb-access-token');
const refreshToken = cookies.get('sb-refresh-token');
let user = null;

if (accessToken && refreshToken) {
	const { data: sessionData, error } = await supabase.auth.setSession({
		refresh_token: refreshToken.value,
		access_token: accessToken.value,
	});
	if (!error && sessionData?.session) {
		const { data: userData, error: userError } = await supabase.auth.getUser();
		if (!userError) {
			user = userData.user;
		} else {
			cookies.delete('sb-access-token', { path: '/' });
			cookies.delete('sb-refresh-token', { path: '/' });
		}
	} else {
		cookies.delete('sb-access-token', { path: '/' });
		cookies.delete('sb-refresh-token', { path: '/' });
	}
}

const status = Astro.url.searchParams.get('status'); // "success" | "error"
const msg = Astro.url.searchParams.get('msg') || '';
const isSuccess = status === 'success';
const variant = isSuccess
	? 'text-green-800 border-green-300 bg-green-50 dark:text-green-400 dark:border-green-800 dark:bg-[#1d1d1d]'
	: 'text-red-800 border-red-300 bg-red-50 dark:text-red-400 dark:border-red-800 dark:bg-[#1d1d1d]';

// visible si hay msg; si no, hidden
const display = msg ? 'flex' : 'hidden';
---
<!-- ALERTA FLOWBITE -->
	<div
		id="alert-feedback"
		class={`absolute right-0 top-0.5 items-center p-4 mb-4 text-sm border rounded-lg mt-4 ${variant} ${display}`}
		role="alert"
		style="z-index: 50;"
		aria-live="polite"
	>
		<svg
			class="shrink-0 inline w-4 h-4 me-3"
			aria-hidden="true"
			xmlns="http://www.w3.org/2000/svg"
			fill="currentColor"
			viewBox="0 0 20 20"
		>
			<path
				d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"
			></path>
		</svg>
		<div class="ms-3">
			<span class="font-medium">{isSuccess ? '‚úÖ ¬°√âxito!' : '‚ùå Error:'}</span>
			{' '}
			{msg}
		</div>
		<!-- bot√≥n cerrar (opcional) -->
		<button
			type="button"
			class="ms-auto -mx-1.5 -my-1.5 p-1.5 rounded hover:opacity-80"
			aria-label="Close"
			data-close
		>
			‚úï
		</button>
	</div>

	<!-- Script: mostrar/ocultar y limpiar query -->
	<script is:inline>
		(function () {
			const alertBox = document.getElementById('alert-feedback');
			if (!alertBox) return;

			const params = new URLSearchParams(window.location.search);
			const hasMsg = params.has('msg');

			// por si el SSR no lo dej√≥ visible
			if (hasMsg) {
				alertBox.classList.remove('hidden');
				alertBox.classList.add('flex');

				// autocerrar a los 6s
				const hide = () => {
					alertBox.classList.add('hidden');
					alertBox.classList.remove('flex');
				};
				const timer = setTimeout(hide, 6000);

				// bot√≥n cerrar manual
				const closeBtn = alertBox.querySelector('[data-close]');
				if (closeBtn) {
					closeBtn.addEventListener('click', () => {
						clearTimeout(timer);
						hide();
					});
				}

				// limpiar query de la URL (para que no reaparezca al refrescar)
				params.delete('msg');
				params.delete('status');
				const newUrl = `${location.pathname}${params.toString() ? '?' + params.toString() : ''}${location.hash}`;
				window.history.replaceState({}, '', newUrl);
			} else {
				// asegurar oculto si no hay mensaje
				alertBox.classList.add('hidden');
				alertBox.classList.remove('flex');
			}
		})();
	</script>


<WhatsappBtn />
<!--Modal --><!-- Main modal -->
<div
	id="modalCard"
	aria-hidden="true"
	class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 max-h-full bg-neutral-800 bg-opacity-70 h-full"
>
	<div class="relative p-4 w-full max-w-screen-lg">
		<!-- Modal content -->
		<div class="relative bg-white rounded-lg shadow-sm dark:bg-neutral-800">
			<!-- Modal header -->
			<div
				class="flex items-center justify-between p-4 md:p-5 rounded-t dark:border-gray-600"
			>
				<button
					type="button"
					id="closeBtn"
					class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"
				>
					<svg
						class="w-3 h-3"
						aria-hidden="true"
						xmlns="http://www.w3.org/2000/svg"
						fill="none"
						viewBox="0 0 14 14"
					>
						<path
							stroke="currentColor"
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="2"
							d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path>
					</svg>
					<span class="sr-only">Close modal</span>
				</button>
			</div>
			<!-- Modal body -->
			<div
				class="p-4 md:p-5 space-y-4 text-center flex-col justify-center items-center"
			>
				<h3
					class="text-3xl font-semibold text-gray-900 dark:text-white text-center md:w-3/5 w-4/5 mx-auto mb-10"
				>
					Encuentre el tipo de entidad adecuado para su negocio
				</h3>
				<p
					class="text-lg leading-relaxed text-gray-500 dark:text-gray-400 md:w-3/5 w-4/5 mx-auto my-10 text-justify"
				>
					La elecci√≥n de tu entidad legal es el primer gran paso. Evita riesgos
					fiscales y legales. Nuestros consultores te brindan una asesor√≠a
					gratuita para identificar la mejor opci√≥n para tu negocio, asegurando
					un crecimiento s√≥lido y protegido en EE. UU.
				</p>
				<div class="flex justify-center w-full h-full text-white mt-10">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="100"
						height="100"
						viewBox="0 0 24 24"
						><g fill="none"
							><path
								fill="currentColor"
								d="M2 9c0-1.886 0-2.828.586-3.414S4.114 5 6 5h12c1.886 0 2.828 0 3.414.586S22 7.114 22 9c0 .471 0 .707-.146.854C21.707 10 21.47 10 21 10H3c-.471 0-.707 0-.854-.146C2 9.707 2 9.47 2 9m0 9c0 1.886 0 2.828.586 3.414S4.114 22 6 22h12c1.886 0 2.828 0 3.414-.586S22 19.886 22 18v-5c0-.471 0-.707-.146-.854C21.707 12 21.47 12 21 12H3c-.471 0-.707 0-.854.146C2 12.293 2 12.53 2 13z"
							></path><path
								stroke="currentColor"
								stroke-linecap="round"
								stroke-width="2"
								d="M7 3v3m10-3v3"></path></g
						></svg
					>
				</div>
			</div>
			<!-- Modal footer -->
			<div
				class="flex items-center p-4 md:p-5 rounded-b dark:border-gray-600 justify-center"
			>
				<a
					type="button"
					href=""
					class="text-white focus:ring-4 focus:outline-none focus:ring-neutral-500 font-medium rounded-lg text-base px-5 py-2.5 text-center dark:bg-[#967432] dark:hover:bg-[#8c681d] dark:focus:ring-neutral-500 w-3/5"
					>Agendar una cita</a
				>
			</div>

			<div class="h-[50px]"></div>
		</div>
	</div>
</div>

<div class="w-full flex justify-center items-center my-8">
	<div class="w-full lg:min-h-[700px] lg:flex lg:flex-col hidden ml-5">
		<div class="mt-16">
			<h3 class="text-white text-2xl">
				Inicie su empresa en EE. UU. en minutos.
			</h3>
			<p class="text-gray-500 w-3/4">
				Responda algunas preguntas para ayudarnos a formar su nueva empresa.
			</p>
		</div>
		<ol class="overflow-hidden space-y-8 w-full mt-8">
			<li
				id="stepli-1"
				class="relative flex-1 after:content-[''] after:w-0.5 after:h-full after:bg-[#8c681d] after:inline-block after:absolute after:-bottom-11 after:left-1/4"
			>
				<button
					class="flex items-center justify-center gap-8 w-full max-w-sm"
					id="paso1btn"
				>
					<div
						id="stepdiv1-1"
						class="flex items-center gap-3.5 bg-neutral-800 p-3.5 rounded-xl relative z-10 border border-[#8c681d] w-full text-left"
					>
						<div
							id="stepdiv2-1"
							class="rounded-lg bg-[#8c681d] flex items-center justify-center"
						>
							<span id="stepspan-1" class="text-white p-3">
								<svg
									xmlns="http://www.w3.org/2000/svg"
									width="24"
									height="24"
									viewBox="0 0 24 24"
									><path
										fill="none"
										stroke="currentColor"
										stroke-linecap="square"
										stroke-width="2"
										d="M12 19V4.5h-.5L9.5 6"></path>
								</svg>
							</span>
						</div>
						<div class="flex items-start rounded-md justify-center flex-col">
							<h6
								id="steph6-1"
								class="text-base font-semibold text-white mb-0.5"
							>
								Tipo de empresa
							</h6>
							<p id="stepp-1" class="text-xs font-normal text-gray-400">
								Elige tu entidad comercial ¬øNo est√°s seguro? te ayudamos a
								elegir.
							</p>
						</div>
					</div>
				</button>
			</li>
			<li
				id="stepli-2"
				class="relative flex-1 after:content-[''] after:w-0.5 after:h-full after:bg-gray-200 after:inline-block after:absolute after:-bottom-12 after:left-1/4"
			>
				<button
					class="flex items-center justify-center gap-8 w-full max-w-sm text-left"
					id="paso2btn"
				>
					<div
						id="stepdiv1-2"
						class="flex items-center gap-3.5 bg-[#1d1d1d] p-3.5 rounded-xl relative z-10 border hover:border-[#8c681d] w-full border-transparent transition-all group"
					>
						<div
							id="stepdiv2-2"
							class="rounded-lg bg-neutral-800 group-hover:bg-[#8c681d] flex items-center justify-center transition-all"
						>
							<span
								id="stepspan-2"
								class="text-gray-600 p-3 group-hover:text-white transition-all"
							>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									width="24"
									height="24"
									viewBox="0 0 24 24"
									><path
										fill="none"
										stroke="currentColor"
										stroke-linecap="square"
										stroke-width="2"
										d="M16 19H8v-2.024a1 1 0 0 1 .37-.776l6.128-4.98A4.07 4.07 0 0 0 16 8.065V8a4 4 0 0 0-8 0"
									></path></svg
								>
							</span>
						</div>
						<div class="flex items-start rounded-md justify-center flex-col">
							<h6
								id="steph6-2"
								class="text-base font-semibold text-gray-500 mb-0.5 group-hover:text-white transition-all"
							>
								Estado de registro
							</h6>
							<p
								id="stepp-2"
								class="text-xs font-normal text-gray-500 group-hover:text-gray-400 transition-all"
							>
								Elija su estado de registro
							</p>
						</div>
					</div>
				</button>
			</li>
			<li id="stepli-3" class="relative flex-1">
				<button
					class="flex items-center justify-center gap-8 w-full max-w-sm text-left"
					id="paso3btn"
				>
					<div
						id="stepdiv1-3"
						class="flex items-center gap-3.5 bg-[#1d1d1d] p-3.5 rounded-xl relative z-10 border hover:border-[#8c681d] w-full border-transparent transition-all group"
					>
						<div
							id="stepdiv2-3"
							class="rounded-lg bg-neutral-800 group-hover:bg-[#8c681d] flex items-center justify-center transition-all"
						>
							<span
								id="stepspan-3"
								class="text-gray-600 p-3 group-hover:text-white transition-all"
							>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									width="24"
									height="24"
									viewBox="0 0 24 24"
									><path
										fill="none"
										stroke="currentColor"
										stroke-linecap="square"
										stroke-width="2"
										d="M8.5 5h7v1.5l-5 3.5v1H12a4 4 0 0 1 0 8h-.5a4 4 0 0 1-4-4"
									></path></svg
								>
							</span>
						</div>
						<div class="flex items-start rounded-md justify-center flex-col">
							<h6
								id="steph6-3"
								class="text-base font-semibold text-gray-500 mb-0.5 group-hover:text-white transition-all"
							>
								Elije el nombre de tu empresa
							</h6>
							<p
								id="stepp-3"
								class="text-xs font-normal text-gray-500 group-hover:text-gray-400 transition-all"
							>
								Elije tres opciones de nombre para tu empresa
							</p>
						</div>
					</div>
				</button>
			</li>
			<li id="stepli-4" class="relative flex-1">
				<button
					class="flex items-center justify-center gap-8 w-full max-w-sm text-left"
					id="paso4btn"
				>
					<div
						id="stepdiv1-4"
						class="flex items-center gap-3.5 bg-[#1d1d1d] p-3.5 rounded-xl relative z-10 border hover:border-[#8c681d] w-full border-transparent transition-all group"
					>
						<div
							id="stepdiv2-4"
							class="rounded-lg bg-neutral-800 group-hover:bg-[#8c681d] flex items-center justify-center transition-all"
						>
							<span
								id="stepspan-4"
								class="text-gray-600 p-3 group-hover:text-white transition-all"
							>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									width="24"
									height="24"
									viewBox="0 0 24 24"
									><path
										fill="none"
										stroke="currentColor"
										stroke-linecap="square"
										stroke-width="2"
										d="M14.5 19v-4m0 0H7v-1l6.5-9h1zm0 0h2"></path></svg
								>
							</span>
						</div>
						<div class="flex items-start rounded-md justify-center flex-col">
							<h6
								id="steph6-4"
								class="text-base font-semibold text-gray-500 mb-0.5 group-hover:text-white transition-all"
							>
								Verifica tus datos y registrat√©
							</h6>
							<p
								id="stepp-4"
								class="text-xs font-normal text-gray-500 group-hover:text-gray-400 transition-all"
							>
								Verifica los datos que seleccionaste y registrate para entrar a
								nuestra plataforma.
							</p>
						</div>
					</div>
				</button>
			</li>
		</ol>
	</div>
	<div
		class="rounded-lg w-full flex justify-center flex-col items-center m-auto h-full drop-shadow-xl place-self-center test bg-center bg-cover bg-neutral-700 bg-clip-padding backdrop-filter backdrop-blur-md bg-opacity-20 backdrop-saturate-100 backdrop-contrast-100 py-20 mr-5 z-20"
	>
		<form id="business-form" class="w-full">
			<input type="hidden" name="estado_de" value="En proceso" />
			<div id="paso1">
				<div class="text-center pb-10">
					<h3 class="text-white text-3xl">Estructura de la empresa</h3>
					<p class="text-gray-400">
						Elija el tipo de entidad adecuada para su negocio.
					</p>
				</div>
				<ul class="grid w-full gap-6 place-items-center">
					<li class="md:w-3/5 w-4/5">
						<input
							type="radio"
							id="LLC_radio_btn"
							name="tipo_de_empresa"
							value="LLC"
							class="hidden peer"
							checked
							required
						/>
						<label
							for="LLC_radio_btn"
							class="inline-flex items-center justify-between w-full p-5 border rounded-lg cursor-pointer dark:hover:text-white dark:border-gray-700 dark:peer-checked:text-[#8c681d] peer-checked:border-[#8c681d] dark:peer-checked:border-[#8c681d] peer-checked:text-[#8c681d] hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-neutral-800 dark:hover:bg-[#1d1d1d] dark:peer-checked:bg-[#1d1d1d]"
						>
							<div class="block">
								<div class="w-full text-lg font-semibold">LLC</div>
								<div class="w-full text-sm">
									Tarifas m√≠nimas + privacidad y flexibilidad inigualables.
								</div>
							</div>
							<svg
								class="w-5 h-5 ms-3 rtl:rotate-180"
								aria-hidden="true"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 14 10"
							>
								<path
									stroke="currentColor"
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M1 5h12m0 0L9 1m4 4L9 9"></path>
							</svg>
						</label>
					</li>
					<li class="md:w-3/5 w-4/5">
						<input
							type="radio"
							id="C_coorp_btn_radio"
							name="tipo_de_empresa"
							value="C-corporation"
							class="hidden peer"
							required
						/>
						<label
							for="C_coorp_btn_radio"
							class="inline-flex items-center justify-between w-full p-5 border rounded-lg cursor-pointer dark:hover:text-white dark:border-gray-700 dark:peer-checked:text-[#8c681d] peer-checked:border-[#8c681d] dark:peer-checked:border-[#8c681d] peer-checked:text-[#8c681d] hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-neutral-800 dark:hover:bg-[#1d1d1d] dark:peer-checked:bg-[#1d1d1d]"
						>
							<div class="block">
								<div class="w-full text-lg font-semibold">C-corporation</div>
								<div class="w-full text-sm">
									Ideal para startups que planean buscar financiaci√≥n externa.
								</div>
							</div>
							<svg
								class="w-5 h-5 ms-3 rtl:rotate-180"
								aria-hidden="true"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 14 10"
							>
								<path
									stroke="currentColor"
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M1 5h12m0 0L9 1m4 4L9 9"></path>
							</svg>
						</label>
					</li>
					<li class="md:w-3/5 w-4/5">
						<button
							id="openBtnxd"
							type="button"
							class="inline-flex items-center justify-between w-full p-5 border rounded-lg cursor-pointer dark:hover:text-white dark:border-gray-700 dark:focus:text-[#8c681d] focus:border-[#8c681d] dark:focus:border-[#8c681d] focus:text-[#8c681d] hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-neutral-800 dark:hover:bg-[#1d1d1d] dark:focus:bg-[#1d1d1d] text-left"
						>
							<div class="block">
								<div class="w-full text-lg font-semibold">Ay√∫dame a elegir</div>
								<div class="w-full text-sm">
									Responda nuestro cuestionario LLC vs. C Corp para obtener una
									recomendaci√≥n personalizada.
								</div>
							</div>
							<svg
								class="w-5 h-5 ms-3 rtl:rotate-180"
								aria-hidden="true"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 14 10"
							>
								<path
									stroke="currentColor"
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M1 5h12m0 0L9 1m4 4L9 9"></path>
							</svg>
						</button>
					</li>
				</ul>
				<div class="w-full flex justify-center mt-8">
					<button
						type="button"
						id="continuarBtn"
						class="text-white bg-gradient-to-r from-[#8c681d] via-[#795918] to-[#5f4610] hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-neutral-600 dark:focus:ring-neutral-500 font-medium rounded-lg md:text-lg px-5 py-2.5 text-center me-2 mb-2 md:w-3/5 w-4/5"
						>Continuar</button
					>
				</div>
			</div>
			<div id="paso2" class="hidden">
				<div class="relative">
					<button
						type="button"
						id="atrasBtn"
						class="text-neutral-500 focus:ring-4 focus:outline-none focus:ring-neutral-600 dark:focus:ring-neutral-500 font-medium text-center flex items-center absolute left-5 bottom-10"
						><span
							><svg
								xmlns="http://www.w3.org/2000/svg"
								width="24"
								height="24"
								viewBox="0 0 24 24"
								><path
									fill="currentColor"
									d="M17 11H9.41l3.3-3.29a1 1 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33a1 1 0 0 0 0 .76a1 1 0 0 0 .21.33l5 5a1 1 0 0 0 1.42 0a1 1 0 0 0 0-1.42L9.41 13H17a1 1 0 0 0 0-2"
								></path></svg
							></span
						> atr√°s</button
					>
				</div>
				<div class="text-center pb-5">
					<h3 class="text-white text-3xl">Elija el estado de registro</h3>
					<p class="text-gray-400">Estados populares</p>
					<ol class="mt-3 flex justify-center">
						<li>
							<span
								class="bg-yellow-100 text-white text-sm font-medium me-2 px-2.5 py-0.5 rounded-full dark:bg-[#967432] dark:text-white"
								>Delaware</span
							>
						</li>
						<li>
							<span
								class="bg-yellow-100 text-white text-sm font-medium me-2 px-2.5 py-0.5 rounded-full dark:bg-[#967432] dark:text-white"
								>Wyoming</span
							>
						</li>
					</ol>
				</div>
				<ul class="grid w-full gap-3 place-items-center">
					<li class="md:w-3/5 w-4/5">
						<div id="seleccionar" class="mt-5">
							<select
								id="estados"
								name="estado_de_empresa"
								class="inline-flex items-center justify-between w-full p-5 border rounded-lg cursor-pointer dark:hover:text-white dark:border-neutral-700 dark:peer-checked:text-[#8c681d] peer-checked:border-[#8c681d] dark:peer-checked:border-[#8c681d] peer-checked:text-[#8c681d] hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-neutral-800 dark:hover:bg-[#1d1d1d] dark:peer-checked:bg-[#1d1d1d] dark:focus:ring-neutral-600"
								required
							>
								<option value="Alabama">Alabama</option>
								<option value="Alaska">Alaska</option>
								<option value="Arizona">Arizona</option>
								<option value="Arkansas">Arkansas</option>
								<option value="California">California</option>
								<option value="Colorado">Colorado</option>
								<option value="Connecticut">Connecticut</option>
								<option value="Delaware">Delaware</option>
								<option value="District Of Columbia"
									>District Of Columbia</option
								>
								<option value="Florida">Florida</option>
								<option value="Georgia">Georgia</option>
								<option value="Hawaii">Hawaii</option>
								<option value="Idaho">Idaho</option>
								<option value="Illinois">Illinois</option>
								<option value="Indiana">Indiana</option>
								<option value="Iowa">Iowa</option>
								<option value="Kansas">Kansas</option>
								<option value="Kentucky">Kentucky</option>
								<option value="Louisiana">Louisiana</option>
								<option value="Maine">Maine</option>
								<option value="Maryland">Maryland</option>
								<option value="Massachusetts">Massachusetts</option>
								<option value="Michigan">Michigan</option>
								<option value="Minnesota">Minnesota</option>
								<option value="Mississippi">Mississippi</option>
								<option value="Missouri">Missouri</option>
								<option value="Montana">Montana</option>
								<option value="Nebraska">Nebraska</option>
								<option value="Nevada">Nevada</option>
								<option value="New Hampshire">New Hampshire</option>
								<option value="New Jersey">New Jersey</option>
								<option value="New Mexico">New Mexico</option>
								<option value="New York">New York</option>
								<option value="North Carolina">North Carolina</option>
								<option value="North Dakota">North Dakota</option>
								<option value="Ohio">Ohio</option>
								<option value="Oklahoma">Oklahoma</option>
								<option value="Oregon">Oregon</option>
								<option value="Pennsylvania">Pennsylvania</option>
								<option value="Rhode Island">Rhode Island</option>
								<option value="South Carolina">South Carolina</option>
								<option value="South Dakota">South Dakota</option>
								<option value="Tennessee">Tennessee</option>
								<option value="Texas">Texas</option>
								<option value="Utah">Utah</option>
								<option value="Vermont">Vermont</option>
								<option value="Virginia">Virginia</option>
								<option value="Washington">Washington</option>
								<option value="West Virginia">West Virginia</option>
								<option value="Wisconsin">Wisconsin</option>
								<option value="Wyoming" selected>Wyoming</option>
							</select>
						</div>
					</li>
				</ul>
				<div class="w-full flex justify-center mt-8">
					<button
						type="button"
						id="continuarBtn2"
						class="text-white bg-gradient-to-r from-[#8c681d] via-[#795918] to-[#5f4610] hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-neutral-600 dark:focus:ring-neutral-500 font-medium rounded-lg md:text-lg px-5 py-2.5 text-center me-2 mb-2 md:w-3/5 w-4/5"
						>Continuar</button
					>
				</div>
			</div>
			<div id="paso3" class="hidden">
				<div class="relative">
					<button
						type="button"
						id="atrasBtn4"
						class="text-neutral-500 focus:ring-4 focus:outline-none focus:ring-neutral-600 dark:focus:ring-neutral-500 font-medium text-center flex items-center absolute left-5 bottom-10"
						><span
							><svg
								xmlns="http://www.w3.org/2000/svg"
								width="24"
								height="24"
								viewBox="0 0 24 24"
								><path
									fill="currentColor"
									d="M17 11H9.41l3.3-3.29a1 1 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33a1 1 0 0 0 0 .76a1 1 0 0 0 .21.33l5 5a1 1 0 0 0 1.42 0a1 1 0 0 0 0-1.42L9.41 13H17a1 1 0 0 0 0-2"
								></path></svg
							></span
						> atr√°s</button
					>
				</div>
				<div class="text-center pb-10">
					<h3 class="text-white text-3xl">Escoge el nombre de tu empresa</h3>
					<p class="text-gray-400">
						Elije los nombres que mas se adapten a tu empresa
					</p>
				</div>
				<ul class="flex w-full gap-2 place-items-center flex-col px-10">
					<li class="m-2 w-full md:w-3/5 h-full">
						<label
							for="nombre-empresa-1"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400"
							>Nombre de tu empresa - (opcion #1)</label
						>
						<div class="flex">
							<span
								class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border rounded-e-0 border-gray-300 border-e-0 rounded-s-md dark:bg-[#8c681d] dark:text-gray-400 dark:border-gray-600"
							>
								<svg
									class="w-4 h-4 text-white dark:text-white"
									viewBox="0 0 48 48"
									><g
										fill="none"
										stroke="currentColor"
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="4"
										><path
											fill="currentColor"
											fill-rule="evenodd"
											d="M11 14L25 4v40H11z"
											clip-rule="evenodd"></path><path
											d="m25 13l14 10v21M4 44h40"></path></g
									></svg
								>
							</span>
							<input
								type="text"
								id="nombre-empresa-1"
								name="nombre_1"
								class="rounded-none rounded-e-lg bg-gray-50 border text-gray-900 focus:ring-[#8c681d] focus:border-[#8c681d] min-w-10 w-full text-sm border-gray-300 p-2.5 dark:bg-[#1d1d1d] dark:border-[#8c681d] dark:placeholder-gray-500 dark:text-white dark:focus:ring-[#8c681d] dark:focus:border-[#8c681d]"
								placeholder="Sotomayor Consulting"
								required
							/>
						</div>
					</li>
					<li class="m-2 w-full md:w-3/5 h-full">
						<label
							for="nombre-empresa-2"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400"
							>Nombre de tu empresa - (opcion #2)</label
						>
						<div class="flex">
							<span
								class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border rounded-e-0 border-gray-300 border-e-0 rounded-s-md dark:bg-[#8c681d] dark:text-gray-400 dark:border-gray-600"
							>
								<svg
									class="w-4 h-4 text-white dark:text-white"
									viewBox="0 0 48 48"
									><g
										fill="none"
										stroke="currentColor"
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="4"
										><path
											fill="currentColor"
											fill-rule="evenodd"
											d="M11 14L25 4v40H11z"
											clip-rule="evenodd"></path><path
											d="m25 13l14 10v21M4 44h40"></path></g
									></svg
								>
							</span>
							<input
								type="text"
								id="nombre-empresa-2"
								name="nombre_2"
								class="rounded-none rounded-e-lg bg-gray-50 border text-gray-900 focus:ring-[#8c681d] focus:border-[#8c681d] min-w-10 w-full text-sm border-gray-300 p-2.5 dark:bg-[#1d1d1d] dark:border-[#8c681d] dark:placeholder-gray-500 dark:text-white dark:focus:ring-[#8c681d] dark:focus:border-[#8c681d]"
								placeholder="Sotomayor Consulting Internacional"
								required
							/>
						</div>
					</li>
					<li class="m-2 w-full md:w-3/5 h-full">
						<label
							for="nombre-empresa-3"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400"
							>Nombre de tu empresa - (opcion #3)</label
						>
						<div class="flex">
							<span
								class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border rounded-e-0 border-gray-300 border-e-0 rounded-s-md dark:bg-[#8c681d] dark:text-gray-400 dark:border-gray-600"
							>
								<svg
									class="w-4 h-4 text-white dark:text-white"
									viewBox="0 0 48 48"
									><g
										fill="none"
										stroke="currentColor"
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="4"
										><path
											fill="currentColor"
											fill-rule="evenodd"
											d="M11 14L25 4v40H11z"
											clip-rule="evenodd"></path><path
											d="m25 13l14 10v21M4 44h40"></path></g
									></svg
								>
							</span>
							<input
								type="text"
								id="nombre-empresa-3"
								name="nombre_3"
								class="rounded-none rounded-e-lg bg-gray-50 border text-gray-900 focus:ring-[#8c681d] focus:border-[#8c681d] min-w-10 w-full text-sm border-gray-300 p-2.5 dark:bg-[#1d1d1d] dark:border-[#8c681d] dark:placeholder-gray-500 dark:text-white dark:focus:ring-[#8c681d] dark:focus:border-[#8c681d]"
								placeholder="Sotomayor"
								required
							/>
						</div>
					</li>
				</ul>
				<div class="w-full flex justify-center mt-8">
					<button
						type="button"
						id="continuarBtn3"
						class="text-white bg-gradient-to-r from-[#8c681d] via-[#795918] to-[#5f4610] hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-neutral-600 dark:focus:ring-neutral-500 font-medium rounded-lg md:text-lg px-5 py-2.5 text-center me-2 mb-2 md:w-3/5 w-4/5"
						>Continuar</button
					>
				</div>
			</div>
			<div id="paso4" class="hidden">
				<div class="relative">
					<button
						type="button"
						id="atrasBtn2"
						class="text-neutral-500 focus:ring-4 focus:outline-none focus:ring-neutral-600 dark:focus:ring-neutral-500 font-medium text-center flex items-center absolute left-5 bottom-10"
						><span
							><svg
								xmlns="http://www.w3.org/2000/svg"
								width="24"
								height="24"
								viewBox="0 0 24 24"
								><path
									fill="currentColor"
									d="M17 11H9.41l3.3-3.29a1 1 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33a1 1 0 0 0 0 .76a1 1 0 0 0 .21.33l5 5a1 1 0 0 0 1.42 0a1 1 0 0 0 0-1.42L9.41 13H17a1 1 0 0 0 0-2"
								></path></svg
							></span
						> atr√°s</button
					>
				</div>
				<div class="text-center pb-5">
					<h3 class="text-white text-3xl">Revisar e iniciar sesion</h3>
					<p class="text-gray-400 mt-1">Ya casi terminas. üéâ</p>
					<p class="text-gray-400">
						Por favor revisa tu informaci√≥n y procede a registrarte.
					</p>
				</div>
				<ul class="grid w-full gap-3 place-items-center">
					<li class="md:w-3/5 w-4/5">
						<div id="respuestasradio" class="mt-5">
							<div
								class="flex justify-between items-center w-full p-5 border rounded-lg dark:hover:text-white dark:border-neutral-700 dark:peer-checked:text-[#8c681d] peer-checked:border-[#8c681d] dark:peer-checked:border-[#8c681d] peer-checked:text-[#8c681d] hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-neutral-800 dark:peer-checked:bg-[#1d1d1d] dark:focus:ring-neutral-600"
							>
								<div>
									<p class="text-gray-400 mt-1 text-sm">Tipo de empresa</p>
									<h3 id="radioResultado" class="text-white text-xl">
										No has seleccionada nada
									</h3>
								</div>
								<button
									id="editar1"
									type="button"
									class="flex justify-center items-center p-1 border rounded-lg cursor-pointer dark:bg-neutral-800 dark:hover:bg-[#1d1d1d]"
									title="editar"
								>
									<svg
										xmlns="http://www.w3.org/2000/svg"
										width="24"
										height="24"
										viewBox="0 0 24 24"
										><path
											fill="currentColor"
											d="M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"
										></path></svg
									>
								</button>
							</div>
						</div>
						<div id="respuesta_estado" class="mt-5">
							<div
								class="flex justify-between items-center w-full p-5 border rounded-lg dark:hover:text-white dark:border-neutral-700 dark:peer-checked:text-[#8c681d] peer-checked:border-[#8c681d] dark:peer-checked:border-[#8c681d] peer-checked:text-[#8c681d] hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-neutral-800 dark:peer-checked:bg-[#1d1d1d] dark:focus:ring-neutral-600"
							>
								<div>
									<p class="text-gray-400 mt-1 text-sm">
										Estado en el cual se va a registrar
									</p>
									<h3 id="selectResultado" class="text-white text-xl">
										No has seleccionada nada
									</h3>
								</div>
								<button
									id="editar2"
									type="button"
									class="flex justify-center items-center p-1 border rounded-lg cursor-pointer dark:bg-neutral-800 dark:hover:bg-[#1d1d1d]"
									title="editar"
								>
									<svg
										xmlns="http://www.w3.org/2000/svg"
										width="24"
										height="24"
										viewBox="0 0 24 24"
										><path
											fill="currentColor"
											d="M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"
										></path></svg
									>
								</button>
							</div>
						</div>
						<div id="respuesta_plan" class="mt-5">
							<div
								class="flex justify-between items-center w-full p-5 border rounded-lg dark:hover:text-white dark:border-neutral-700 dark:peer-checked:text-[#8c681d] peer-checked:border-[#8c681d] dark:peer-checked:border-[#8c681d] peer-checked:text-[#8c681d] hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-neutral-800 dark:peer-checked:bg-[#1d1d1d] dark:focus:ring-neutral-600"
							>
								<div>
									<p class="text-gray-400 mt-1 text-sm">
										El nombre que seleccionaste
									</p>
									<h3 id="ResultadoPlan" class="text-white text-xl">
										No has seleccionada nada
									</h3>
								</div>
								<button
									id="editar3"
									type="button"
									class="flex justify-center items-center p-1 border rounded-lg cursor-pointer dark:bg-neutral-800 dark:hover:bg-[#1d1d1d]"
									title="editar"
								>
									<svg
										xmlns="http://www.w3.org/2000/svg"
										width="24"
										height="24"
										viewBox="0 0 24 24"
										><path
											fill="currentColor"
											d="M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"
										></path></svg
									>
								</button>
							</div>
						</div>
					</li>
				</ul>
				<div class="w-full flex justify-center mt-8">
					<button
						type="button"
						id="boton-verificar"
						class="text-white bg-gradient-to-r from-[#8c681d] via-[#795918] to-[#5f4610] hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-neutral-600 dark:focus:ring-neutral-500 font-medium rounded-lg md:text-lg px-5 py-2.5 text-center me-2 mb-2 md:w-3/5 w-4/5"
						>Verificar informaci√≥n</button
					>
				</div>
			</div>
		</form>
		<div
			id="contenedor-registro"
			class="w-full flex-col items-center justify-center px-6 pt-8 mx-auto pt:mt-0 hidden"
		>
			<!-- Card -->
			<div
				class="w-full max-w-xl p-6 space-y-8 sm:p-8 bg-gray-200 rounded-lg shadow dark:bg-[#1d1d1d]"
			>
				<a
					href="#"
					class="flex items-center justify-center mb-8 text-2xl font-semibold lg:mb-10 dark:text-white"
				>
					<img
						src="/src/assets/SC-INTER.png"
						alt="Sotomayor Logo"
						class="mr-4 h-11 dark:block hidden"
					/>
					<img
						src="/src/assets/SC-INTER-NG.png"
						alt="Sotomayor Logo"
						class="mr-4 h-11 dark:hidden block"
					/>
				</a>
				<h2 class="text-2xl font-bold text-gray-900 dark:text-white">
					Crea tu cuenta gratuita
				</h2>
				<form class="mt-8 space-y-6" id="form-registro">
					<div class="grid grid-cols-2 gap-x-6 gap-y-8">
						<div class="col">
							<label
								for="name"
								class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
								>Nombre</label
							>
							<input
								type="text"
								name="name"
								id="name"
								class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-neutral-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
								placeholder="Nombre"
								required
							/>
						</div>
						<div class="col">
							<label
								for="last-name"
								class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
								>Apellido</label
							>
							<input
								type="text"
								name="last-name"
								id="last-name"
								class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-neutral-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
								placeholder="Apellido"
								required
							/>
						</div>
					</div>
					<div>
						<label
							for="email"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
							>Tu correo</label
						>
						<input
							type="email"
							name="email"
							id="email"
							class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-neutral-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
							placeholder="correo@ejemplo.com"
							required
						/>
					</div>
					<div>
						<label
							for="password"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
							>Contrase√±a</label
						>
						<input
							type="password"
							name="password"
							minlength="8"
							pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
							title="M√≠nimo 8 caracteres, una may√∫scula, una min√∫scula y un n√∫mero"
							id="password"
							placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
							class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-neutral-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
							required
						/>
					</div>
					<div>
						<label
							for="confirm-password"
							class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
							>Confirmar contrase√±a</label
						>
						<input
							type="password"
							name="confirm-password"
							id="confirm-password"
							placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
							class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-neutral-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
							required
						/>
					</div>
					<div class="flex items-start">
						<div class="flex items-center h-5">
							<input
								id="remember"
								aria-describedby="remember"
								name="remember"
								type="checkbox"
								class="w-4 h-4 border-gray-500 rounded bg-gray-50 focus:ring-3 focus:ring-primary-300 dark:focus:ring-[#967432] dark:ring-offset-gray-800 dark:bg-neutral-700 dark:border-gray-600"
								required
							/>
						</div>
						<div class="ml-3 text-sm">
							<label
								for="remember"
								class="font-medium text-gray-900 dark:text-white"
								>Al registrarte, est√°s creando una cuenta de Sotomayor
								consulting y aceptas los <a
									href="#"
									class="text-[#8c681d] hover:underline dark:text-primary-500"
									>T√©rminos de uso y la Pol√≠tica de privacidad</a
								> de Sotomayor Consulting.
							</label>
						</div>
					</div>
					<button
						type="submit"
						class="w-full px-5 py-3 text-base font-medium text-center text-white bg-[#8c681d] rounded-lg hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 dark:bg-[#967432] dark:hover:bg-[#8c681d] dark:focus:ring-primary-800"
						>Crear una cuenta</button
					>
				</form>
				<div>
					<div class="inline-flex items-center justify-center w-full">
						<hr
							class="w-11/12 h-px my-2 border-0 dark:bg-neutral-700 bg-gray-300"
						/>
						<span
							class="absolute px-5 font-medium text-gray-900 dark:text-white"
						>
							o
						</span>
					</div>
				</div>
				<div>
					<form action="/api/auth/google" method="post">
						<button
							class="w-full flex border dark:border-white border-gray-500 rounded-lg dark:text-white gap-2 items-center justify-center p-2.5 dark:hover:bg-slate-300/10 hover:bg-slate-700/10"
							name="provider"
							id="googleBtn"
							type="submit"
						>
							<svg
								class="w-6"
								viewBox="0 0 21 20"
								fill="none"
								xmlns="http://www.w3.org/2000/svg"
							>
								<g clip-path="url(#clip0_13183_10121)"
									><path
										d="M20.3081 10.2303C20.3081 9.55056 20.253 8.86711 20.1354 8.19836H10.7031V12.0492H16.1046C15.8804 13.2911 15.1602 14.3898 14.1057 15.0879V17.5866H17.3282C19.2205 15.8449 20.3081 13.2728 20.3081 10.2303Z"
										fill="#3F83F8"></path><path
										d="M10.7019 20.0006C13.3989 20.0006 15.6734 19.1151 17.3306 17.5865L14.1081 15.0879C13.2115 15.6979 12.0541 16.0433 10.7056 16.0433C8.09669 16.0433 5.88468 14.2832 5.091 11.9169H1.76562V14.4927C3.46322 17.8695 6.92087 20.0006 10.7019 20.0006V20.0006Z"
										fill="#34A853"></path><path
										d="M5.08857 11.9169C4.66969 10.6749 4.66969 9.33008 5.08857 8.08811V5.51233H1.76688C0.348541 8.33798 0.348541 11.667 1.76688 14.4927L5.08857 11.9169V11.9169Z"
										fill="#FBBC04"></path><path
										d="M10.7019 3.95805C12.1276 3.936 13.5055 4.47247 14.538 5.45722L17.393 2.60218C15.5852 0.904587 13.1858 -0.0287217 10.7019 0.000673888C6.92087 0.000673888 3.46322 2.13185 1.76562 5.51234L5.08732 8.08813C5.87733 5.71811 8.09302 3.95805 10.7019 3.95805V3.95805Z"
										fill="#EA4335"></path></g
								><defs
									><clipPath id="clip0_13183_10121"
										><rect
											width="20"
											height="20"
											fill="white"
											transform="translate(0.5)"></rect></clipPath
									></defs
								>
							</svg>
							<label for="googleBtn">Reg√≠strate con google</label>
						</button>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	const boton = document.getElementById('openBtnxd');
	const modal = document.getElementById('modalCard');
	const cerrar = document.getElementById('closeBtn');

	boton?.addEventListener('click', function () {
		modal?.classList.remove('hidden');
		modal?.classList.add('flex');
	});

	cerrar?.addEventListener('click', function () {
		modal?.classList.add('hidden');
		modal?.classList.remove('flex');
	});

	//logica del stepper
	let pasoActual = 0;

	// variables activas
	const activoli = [
		'relative',
		'flex-1',
		"after:content-['']",
		'after:w-0.5',
		'after:h-full',
		'after:bg-[#8c681d]',
		'after:inline-block',
		'after:absolute',
		'after:-bottom-11',
		'after:left-1/4',
	];
	const activodiv1 = [
		'flex',
		'items-center',
		'gap-3.5',
		'bg-neutral-800',
		'p-3.5',
		'rounded-xl',
		'relative',
		'z-10',
		'border',
		'border-[#8c681d]',
		'w-full',
	];
	const activodiv2 = [
		'rounded-lg',
		'bg-[#8c681d]',
		'flex',
		'items-center',
		'justify-center',
	];
	const activospan = ['text-white', 'p-3'];
	const activoh6 = ['text-base', 'font-semibold', 'text-white', 'mb-0.5'];
	const activop = ['text-xs', 'font-normal', 'text-gray-400'];

	// variables inactivas
	const inactivoli = [
		'relative',
		'flex-1',
		"after:content-['']",
		'after:w-0.5',
		'after:h-full',
		'after:bg-gray-200',
		'after:inline-block',
		'after:absolute',
		'after:-bottom-12',
		'after:left-1/4',
	];
	const inactivodiv1 = [
		'flex',
		'items-center',
		'gap-3.5',
		'bg-[#1d1d1d]',
		'p-3.5',
		'rounded-xl',
		'relative',
		'z-10',
		'border',
		'hover:border-[#8c681d]',
		'w-full',
		'border-transparent',
		'transition-all',
		'group',
	];
	const inactivodiv2 = [
		'rounded-lg',
		'bg-neutral-800',
		'group-hover:bg-[#8c681d]',
		'flex',
		'items-center',
		'justify-center',
		'transition-all',
	];
	const inactivospan = [
		'text-gray-600',
		'p-3',
		'group-hover:text-white',
		'transition-all',
	];
	const inactivoh6 = [
		'text-base',
		'font-semibold',
		'text-gray-500',
		'mb-0.5',
		'group-hover:text-white',
		'transition-all',
	];
	const inactivop = [
		'text-xs',
		'font-normal',
		'text-gray-500',
		'group-hover:text-gray-400',
		'transition-all',
	];

	//botones y elementos
	const botonstep1 = document.getElementById('paso1btn');
	const botonstep2 = document.getElementById('paso2btn');
	const botonstep3 = document.getElementById('paso3btn');
	const botonstep4 = document.getElementById('paso4btn');

	const formstep1 = document.getElementById('paso1');
	const formstep2 = document.getElementById('paso2');
	const formstep3 = document.getElementById('paso3');
	const formstep4 = document.getElementById('paso4');

	const contenedorRegistro = document.getElementById('contenedor-registro');

	//elementos
	const elementos = [
		{
			li: document.getElementById('stepli-1'),
			div1: document.getElementById('stepdiv1-1'),
			div2: document.getElementById('stepdiv2-1'),
			span: document.getElementById('stepspan-1'),
			h6: document.getElementById('steph6-1'),
			p: document.getElementById('stepp-1'),
		},
		{
			li: document.getElementById('stepli-2'),
			div1: document.getElementById('stepdiv1-2'),
			div2: document.getElementById('stepdiv2-2'),
			span: document.getElementById('stepspan-2'),
			h6: document.getElementById('steph6-2'),
			p: document.getElementById('stepp-2'),
		},
		{
			li: document.getElementById('stepli-3'),
			div1: document.getElementById('stepdiv1-3'),
			div2: document.getElementById('stepdiv2-3'),
			span: document.getElementById('stepspan-3'),
			h6: document.getElementById('steph6-3'),
			p: document.getElementById('stepp-3'),
		},
		{
			li: document.getElementById('stepli-4'),
			div1: document.getElementById('stepdiv1-4'),
			div2: document.getElementById('stepdiv2-4'),
			span: document.getElementById('stepspan-4'),
			h6: document.getElementById('steph6-4'),
			p: document.getElementById('stepp-4'),
		},
	];

	function aplicarClases(elemento: HTMLElement | null, clases: string[]) {
		if (elemento) {
			elemento.classList.add(...clases);
		}
	}

	function removerClases(elemento: HTMLElement | null, clases: string[]) {
		if (elemento) {
			elemento.classList.remove(...clases);
		}
	}

	function activarPaso(pasoActivo: number) {
		pasoActual = pasoActivo;
		elementos.forEach((paso, index) => {
			const esActivo = index === pasoActivo;

			if (esActivo) {
				// Aplicar clases activas
				removerClases(paso.li, inactivoli);
				removerClases(paso.div1, inactivodiv1);
				removerClases(paso.div2, inactivodiv2);
				removerClases(paso.span, inactivospan);
				removerClases(paso.h6, inactivoh6);
				removerClases(paso.p, inactivop);

				aplicarClases(paso.li, activoli);
				aplicarClases(paso.div1, activodiv1);
				aplicarClases(paso.div2, activodiv2);
				aplicarClases(paso.span, activospan);
				aplicarClases(paso.h6, activoh6);
				aplicarClases(paso.p, activop);
			} else {
				// Aplicar clases inactivas
				removerClases(paso.li, activoli);
				removerClases(paso.div1, activodiv1);
				removerClases(paso.div2, activodiv2);
				removerClases(paso.span, activospan);
				removerClases(paso.h6, activoh6);
				removerClases(paso.p, activop);

				aplicarClases(paso.li, inactivoli);
				aplicarClases(paso.div1, inactivodiv1);
				aplicarClases(paso.div2, inactivodiv2);
				aplicarClases(paso.span, inactivospan);
				aplicarClases(paso.h6, inactivoh6);
				aplicarClases(paso.p, inactivop);
			}
		});
	}

	// eventos
	botonstep1?.addEventListener('click', () => activarPaso(0));
	botonstep2?.addEventListener('click', () => activarPaso(1));
	botonstep3?.addEventListener('click', () => activarPaso(2));
	botonstep4?.addEventListener('click', () => activarPaso(3));

	const botonContinuar = document.getElementById('continuarBtn');
	botonContinuar?.addEventListener('click', function () {
		const siguientePaso = (pasoActual + 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep1?.classList.add('hidden');
		formstep2?.classList.remove('hidden');
	});

	const botonContinuar2 = document.getElementById('continuarBtn2');
	botonContinuar2?.addEventListener('click', function () {
		const siguientePaso = (pasoActual + 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep2?.classList.add('hidden');
		formstep3?.classList.remove('hidden');
	});

	const botonContinuar3 = document.getElementById('continuarBtn3');
	botonContinuar3?.addEventListener('click', function () {
		const siguientePaso = (pasoActual + 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep3?.classList.add('hidden');
		formstep4?.classList.remove('hidden');
	});

	const botonatras = document.getElementById('atrasBtn');
	botonatras?.addEventListener('click', function () {
		const siguientePaso = (pasoActual - 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep2?.classList.add('hidden');
		formstep1?.classList.remove('hidden');
	});

	const botonatras2 = document.getElementById('atrasBtn2');
	botonatras2?.addEventListener('click', function () {
		const siguientePaso = (pasoActual - 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep4?.classList.add('hidden');
		formstep3?.classList.remove('hidden');
	});

	const botonatras3 = document.getElementById('atrasBtn3');
	botonatras3?.addEventListener('click', function () {
		const siguientePaso = (pasoActual - 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep3?.classList.add('hidden');
		formstep2?.classList.remove('hidden');
	});

	const botonatras4 = document.getElementById('atrasBtn4');
	botonatras4?.addEventListener('click', function () {
		const siguientePaso = (pasoActual - 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep3?.classList.add('hidden');
		formstep2?.classList.remove('hidden');
	});

	const botonatras5 = document.getElementById('atrasBtn5');
	botonatras5?.addEventListener('click', function () {
		const siguientePaso = (pasoActual - 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep4?.classList.add('hidden');
		formstep3?.classList.remove('hidden');
	});

	const edicion1 = document.getElementById('editar1');
	edicion1?.addEventListener('click', function () {
		const siguientePaso = (pasoActual - 3) % elementos.length;
		activarPaso(siguientePaso);
		formstep3?.classList.add('hidden');
		formstep4?.classList.add('hidden');
		formstep1?.classList.remove('hidden');
	});

	const edicion2 = document.getElementById('editar2');
	edicion2?.addEventListener('click', function () {
		const siguientePaso = (pasoActual - 2) % elementos.length;
		activarPaso(siguientePaso);
		formstep3?.classList.add('hidden');
		formstep2?.classList.remove('hidden');
		formstep4?.classList.add('hidden');
	});

	const edicion3 = document.getElementById('editar3');
	edicion3?.addEventListener('click', function () {
		const siguientePaso = (pasoActual - 1) % elementos.length;
		activarPaso(siguientePaso);
		formstep4?.classList.add('hidden');
		formstep3?.classList.remove('hidden');
	});

	botonstep1?.addEventListener('click', function () {
		formstep1?.classList.remove('hidden');
		formstep2?.classList.add('hidden');
		formstep3?.classList.add('hidden');
		formstep4?.classList.add('hidden');
		contenedorRegistro?.classList.add('hidden');
	});

	botonstep2?.addEventListener('click', function () {
		formstep1?.classList.add('hidden');
		formstep2?.classList.remove('hidden');
		formstep3?.classList.add('hidden');
		formstep4?.classList.add('hidden');
		contenedorRegistro?.classList.add('hidden');
	});

	botonstep3?.addEventListener('click', function () {
		formstep1?.classList.add('hidden');
		formstep2?.classList.add('hidden');
		formstep3?.classList.remove('hidden');
		formstep4?.classList.add('hidden');
		contenedorRegistro?.classList.add('hidden');
	});

	botonstep4?.addEventListener('click', function () {
		formstep1?.classList.add('hidden');
		formstep2?.classList.add('hidden');
		formstep3?.classList.add('hidden');
		formstep4?.classList.remove('hidden');
		contenedorRegistro?.classList.add('hidden');
	});

	const radios = document.querySelectorAll('input[name="tipo_de_empresa"]');
	const inputNombre = document.querySelector('input[name="nombre_1"]'); // Cambiado a input √∫nico
	const selectEstado = document.querySelector(
		'select[name="estado_de_empresa"]',
	);
	const resultadoEs = document.getElementById('selectResultado');
	const resultado = document.getElementById('radioResultado');
	const resultadoplan = document.getElementById('ResultadoPlan');

	function actualizarTitulo() {
		// Actualizar radio buttons
		const seleccionado = document.querySelector(
			'input[name="tipo_de_empresa"]:checked',
		);
		resultado.textContent = seleccionado
			? seleccionado.value
			: 'No seleccionado';

		// Actualizar select
		resultadoEs.textContent = selectEstado.value || 'No seleccionado';

		// Actualizar input de texto - CORREGIDO
		resultadoplan.textContent = inputNombre
			? inputNombre.value
			: 'No ingresado';
	}

	// Inicializar al cargar
	document.addEventListener('DOMContentLoaded', actualizarTitulo);

	// Eventos para radios
	radios.forEach((radio) => {
		radio.addEventListener('change', actualizarTitulo);
	});

	// Evento para input de texto - CORREGIDO (usamos 'input' para capturar en tiempo real)
	if (inputNombre) {
		inputNombre.addEventListener('input', actualizarTitulo);
	}

	// Evento para select
	selectEstado?.addEventListener('change', actualizarTitulo);

	// Inicializar con el primer paso activo
	activarPaso(0);
</script>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		const paymentPanel = document.getElementById('paso4');
		const registerForm = document.getElementById('contenedor-registro');
		const goToPaymentBtn = document.getElementById('boton-verificar');
		const registerFormElement = document.getElementById('form-registro');
		
		// Elementos para la alerta Flowbite
		const alertBox = document.getElementById('alert-feedback');
		const alertMessage = alertBox?.querySelector('.ms-3');

		function showFlowbiteAlert(message: string, isSuccess = false) {
			if (!alertBox || !alertMessage) return;
			
			// Configurar el mensaje
			const prefix = isSuccess ? '‚úÖ ¬°√âxito!' : '‚ùå Error:';
			alertMessage.innerHTML = `<span class="font-medium">${prefix}</span> ${message}`;
			
			// Configurar estilos seg√∫n tipo
			if (isSuccess) {
				alertBox.classList.remove('text-red-800', 'border-red-300', 'bg-red-50', 'dark:text-red-400', 'dark:border-red-800');
				alertBox.classList.add('text-green-800', 'border-green-300', 'bg-green-50', 'dark:text-green-400', 'dark:border-green-800', 'z-50');
			} else {
				alertBox.classList.remove('text-green-800', 'border-green-300', 'bg-green-50', 'dark:text-green-400', 'dark:border-green-800');
				alertBox.classList.add('text-red-800', 'border-red-300', 'bg-red-50', 'dark:text-red-400', 'dark:border-red-800', 'z-50');
			}
			
			// Mostrar alerta
			alertBox.classList.remove('hidden');
			alertBox.classList.add('flex');
			
			// Configurar auto-cierre
			const hide = () => {
				alertBox.classList.add('hidden');
				alertBox.classList.remove('flex');
			};
			const timer = setTimeout(hide, 6000);
			
			// Configurar bot√≥n cerrar
			const closeBtn = alertBox.querySelector('[data-close]');
			if (closeBtn) {
				const newCloseBtn = closeBtn.cloneNode(true);
				closeBtn.parentNode.replaceChild(newCloseBtn, closeBtn);
				newCloseBtn.addEventListener('click', () => {
					clearTimeout(timer);
					hide();
				});
			}
			
			// Limpiar par√°metros URL si existen
			const urlParams = new URLSearchParams(window.location.search);
			if (urlParams.has('msg') || urlParams.has('status')) {
				urlParams.delete('msg');
				urlParams.delete('status');
				const newUrl = `${location.pathname}${urlParams.toString() ? '?' + urlParams.toString() : ''}${location.hash}`;
				window.history.replaceState({}, '', newUrl);
			}
		}

		function showError(element: { textContent: any; classList: { remove: (arg0: string) => void; add: (arg0: string) => void; }; }, message: any) {
			if (element) {
				element.textContent = message;
				element.classList.remove('hidden');
				setTimeout(() => element.classList.add('hidden'), 5000);
			}
		}

		// FUNCI√ìN DE VALIDACI√ìN AGREGADA
		function validateBusinessData(formData: FormData) {
			const nombre_1 = formData.get('nombre_1');
			const nombre_2 = formData.get('nombre_2');
			const nombre_3 = formData.get('nombre_3');

			// Validar que los tres nombres tengan valor
			if (!nombre_1 || nombre_1.trim() === '') {
				return 'El primer nombre de empresa es obligatorio';
			}
			if (!nombre_2 || nombre_2.trim() === '') {
				return 'El segundo nombre de empresa es obligatorio';
			}
			if (!nombre_3 || nombre_3.trim() === '') {
				return 'El tercer nombre de empresa es obligatorio';
			}

			return null; // Sin errores
		}

		function saveBusinessData(formData: FormData) {
			try {
				const data = {
					tipo_de_empresa: formData.get('tipo_de_empresa'),
					estado_de_empresa: formData.get('estado_de_empresa'),
					nombre_1: formData.get('nombre_1'),
					nombre_2: formData.get('nombre_2'),
					nombre_3: formData.get('nombre_3'),
					estado_de: formData.get('estado_de'),
				};

				console.log('Datos a guardar:', data);

				localStorage.setItem('incorpData', JSON.stringify(data));
				return true;
			} catch (error) {
				console.error('Error guardando datos:', error);
				return false;
			}
		}

		async function checkSession() {
			try {
				const response = await fetch('/api/auth/session-check');
				return await response.json();
			} catch (error) {
				return { isAuthenticated: false };
			}
		}

		function handleAuthenticatedUser() {
			window.location.href = '/';
		}

		function handleUnauthenticatedUser() {
			if (paymentPanel) {
				paymentPanel.classList.add('hidden');
				paymentPanel.classList.remove('flex');
			}
			if (registerForm) {
				registerForm.classList.remove('hidden');
				registerForm.classList.add('flex');
			}
		}

		// Evento del bot√≥n de verificaci√≥n - MODIFICADO CON VALIDACI√ìN Y ALERTA FLOWBITE
		goToPaymentBtn?.addEventListener('click', async (e) => {
			e.preventDefault();
			goToPaymentBtn.disabled = true;
			goToPaymentBtn.textContent = 'Verificando...';

			try {
				const businessForm = document.getElementById('business-form');
				if (!businessForm) {
					showFlowbiteAlert('No se encontr√≥ el formulario de negocio');
					return;
				}

				const businessFormData = new FormData(businessForm);
				
				// VALIDACI√ìN AGREGADA AQU√ç
				const validationError = validateBusinessData(businessFormData);
				if (validationError) {
					showFlowbiteAlert(validationError);
					return;
				}

				const businessSaved = saveBusinessData(businessFormData);

				if (!businessSaved) {
					showFlowbiteAlert('Error al guardar los datos del negocio.');
					return;
				}

				const sessionData = await checkSession();
				if (sessionData.isAuthenticated) {
					handleAuthenticatedUser();
				} else {
					handleUnauthenticatedUser();
				}
			} catch (error) {
				console.error('Error:', error);
				showFlowbiteAlert('Error al verificar la sesi√≥n.');
			} finally {
				goToPaymentBtn.disabled = false;
				goToPaymentBtn.textContent = 'Validar Datos';
			}
		});

		// Evento del formulario de registro - AHORA USA FLOWBITE TAMBI√âN
		registerFormElement?.addEventListener('submit', async (e) => {
			e.preventDefault();
			const submitButton = registerFormElement.querySelector(
				'button[type="submit"]',
			);
			if (!submitButton) return;

			const originalText = submitButton.textContent;
			submitButton.disabled = true;
			submitButton.textContent = 'Creando cuenta...';

			try {
				const formData = new FormData(registerFormElement);
				const response = await fetch('/api/auth/register_start', {
					method: 'POST',
					body: formData,
				});

				if (response.ok) {
					const sessionData = await checkSession();
					if (sessionData.isAuthenticated) {
						handleAuthenticatedUser();
					} else {
						showFlowbiteAlert('Registro exitoso. Revisa tu email para confirmar.', true);
					}
				} else {
					const errorText = await response.text();
					showFlowbiteAlert(errorText || 'Error en el registro.');
				}
			} catch (error) {
				console.error('Error en registro:', error);
				showFlowbiteAlert('Error de conexi√≥n.');
			} finally {
				submitButton.disabled = false;
				submitButton.textContent = originalText;
			}
		});

		// Manejo de par√°metros URL - AHORA USA FLOWBITE
		const urlParams = new URLSearchParams(window.location.search);
		if (urlParams.get('status') === 'auth_required') {
			handleUnauthenticatedUser();
		} else if (urlParams.get('status') === 'error') {
			showFlowbiteAlert(
				decodeURIComponent(urlParams.get('msg') || 'Error desconocido')
			);
		} else if (urlParams.get('status') === 'success') {
			showFlowbiteAlert(
				decodeURIComponent(urlParams.get('msg') || 'Operaci√≥n exitosa'),
				true
			);
		}

		// Funci√≥n de debugging para verificar los datos guardados
		function checkStoredData() {
			const stored = localStorage.getItem('incorpData');
			console.log('Datos almacenados actualmente:', stored);
		}

		// Verificar datos al cargar
		checkStoredData();
	});
</script>
